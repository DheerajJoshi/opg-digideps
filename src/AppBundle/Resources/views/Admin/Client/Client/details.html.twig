{% extends 'AppBundle:Layouts:application.html.twig' %}

{% trans_default_domain "admin" %}
{% set page = 'clientDetails' %}

{% block htmlTitle %}{{ (page ~ '.htmlTitle') | trans }}{% endblock %}
{% block pageTitle %}{{ (page ~ '.pageTitle') | trans }}{% endblock %}
{% block pageTitleClass %}heading-large{% endblock %}

{% block supportTitleBottom %}
    <span class="heading-secondary">{{ (page ~ '.supportTitle') | trans }}</span>
{% endblock %}

{% block helpline %}{% endblock %}

{% block pageContent %}

    <p class="flush--bottom">{{ 'client' | trans({}, 'common') }}: <span class="bold">{{ client.fullName }}</span></p>
    <p>{{ 'courtOrderNumber' | trans({}, 'common') }}: <span class="bold">{{ client.caseNumber }}</span></p>

    <h2 class="heading-medium flush--ends">{{ 'reports' | trans({}, 'common') }}</h2>

    {# client report list #}
    {% if client.reports is empty %}
        <p>{{ (page ~ '.reportsTable.noResults') | trans  }}</p>
    {% else %}
        <table class="check-your-answers">
            <thead>
            <tr>
                <th scope="col">{{ 'clientDetails.reportsTable.reportingPeriod' | trans() }}</th>
                <th scope="col">{{ 'clientDetails.reportsTable.dateDue' | trans() }}</th>
                <th scope="col">{{ 'clientDetails.reportsTable.submissionDate' | trans() }}</th>
                <th scope="col">{{ 'clientDetails.reportsTable.status' | trans() }}</th>
                <th scope="col">
                    <span class="visually-hidden">{{ 'clientDetails.reportsTable.actions' | trans() }}</span>
                </th>
            </tr>
            </thead>
            <tbody>
            {% if client.reports | length %}
                {% for report in client.reports %}

                    <tr class="behat-region-client-{{ client.caseNumber }}-{{ report.getPeriod() }}">
                        <td>
                            {{ report.getPeriod() }}
                        </td>
                        <td>
                            {{ report.dueDate | date("j F Y") }}
                        </td>
                        <td>
                            {% if report.submitDate %}
                                {{ report.submitDate | date("j F Y") }}
                            {% endif %}
                        </td>
                        <td>
                            {% if report.submitted %}
                                {% set state = 'submitted' %}
                                {% set statusLabel = 'submitted' %}
                            {% else %}
                                {% set state = report.status.state %}
                                {% set statusLabel = report.status.status %}
                            {% endif %}
                            <span class="status flush--ends {{ report.status.state }}">{{ (statusLabel) | trans({}, 'common') }}</span>
                        </td>
                        <td class="change-answer width-tenth soft-half--left hard--right">
                            <a href="#" class="action-link">Manage</a>
                        </td>
                    </tr>
                {% endfor %}
            {% endif %}
            </tbody>
        </table>
    {% endif %}

{% endblock %}
