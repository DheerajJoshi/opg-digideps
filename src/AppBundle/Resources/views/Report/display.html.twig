{% extends 'AppBundle:Layouts:application.html.twig' %}
{% block pageTitle %}Complete the deputy report{% endblock %}
{% block contentClass %}external-report{% endblock %}
{% set page = 'reportPeriod' %}

{% set translationDomain = "report-overview" %}

{% if constant('AppBundle\\Entity\\Report::PROPERTY_AND_AFFAIRS') == report.courtOrderType %}
    {% set reportType = "propertyAndAffairs" %}
{% else %}
    {% set reportType = "healthAndWelfare" %}
{% endif %}

{% block pageContent %}

    {% if not isEmailAttachment%}
      <div class="navigation-back report-back">
          <a href="{{ path('client_home') }}" class="behat-link-back-to-client">< Back to your client</a>
      </div>
    {% endif %}

    <!-- set class to external-report -->
    {% include 'AppBundle:Components/PageHeader:_report-header-submission.html.twig' %}


    <div class="external-report-section" id="decisions-section">
        {% include 'AppBundle:Components/Page:_page-section-title.html.twig' with {
            transDomain: translationDomain,
            pageSectionTitle: 'decisionsMadeAsDeputy'
        } %}

        {% if report.decisions | length == 0 %}
            <p class="page-section-description">{{ report.reasonForNoDecisions }}</p>
        {% else %}
            {% include 'AppBundle:Decision:_listDecision.html.twig' with {
            'showListData': true,
            'formEditShow': false,
            'showEditLink': false,
            'showDeleteConfirm': false
            } %}
        {% endif %}
    </div>


    <div class="external-report-section" id="contacts-section">
        {% include 'AppBundle:Components/Page:_page-section-title.html.twig' with {
            transDomain: translationDomain,
            pageSectionTitle: 'pages.reportPeriod.healthAndWelfare.contacts.subSectionTitle'
        } %}

        {% if report.contacts | length == 0 %}
            <p class="page-section-description">{{ report.reasonForNoContacts }}</p>
        {% else %}
            {% include 'AppBundle:Contact:_listContact.html.twig' with {
                'showListData': true,
                'formEditShow': false,
                'showEditLink': false,
                'showDeleteConfirm': false
            } %}
        {% endif %}
    </div>

    {% if reportType is sameas("propertyAndAffairs") %}

        {% if report.safeguarding is not null %}
        <div class="external-report-section" id="safeguarding-section">
            {% include 'AppBundle:Safeguard:summary.html.twig' with {
                'safeguarding': report.safeguarding
            } %}
        </div>
        {% endif %}

        <div class="external-report-section" id="accounts-section">
            {% include 'AppBundle:Components/Page:_page-section-title.html.twig' with {
                transDomain: translationDomain,
                pageSectionTitle: 'pages.reportPeriod.propertyAndAffairs.accounts.subSectionTitle'
            } %}

            {% if report.accounts | length == 0 %}
                <p class="page-section-description">{{ report.reasonForNoAccounts }}</p>
            {% else %}
                {% include 'AppBundle:Account:_report_accounts.html.twig' with {
                    'accounts': report.accounts
                } %}
            {% endif %}
        </div>

        <div class="external-report-section" id="assets-section">
            {% include 'AppBundle:Components/Page:_page-section-title.html.twig' with {
                transDomain: translationDomain,
                pageSectionTitle: 'pages.reportPeriod.propertyAndAffairs.assets.subSectionTitle'
            } %}

            {% if report.assets | length == 0 %}
                <p class="page-section-description">{{ 'pages.reportPeriod.propertyAndAffairs.assets.noAssets' | trans({}, translationDomain) }}</p>
            {% else %}
                {{ render(controller('AppBundle:Asset:_list', { 
                    'reportId': report.id, 
                    'showEditLink': false }))
                }}
                
              {#  {% include 'AppBundle:Asset:_list.html.twig' with {
                    'assetToEdit': false,
                    'showDeleteConfirm': false,
                    
                } %}#}
            {% endif %}
        </div>


        {% if  report.furtherInformation %}
          <div class="external-report-section" id="additional-info-section">
              {% include 'AppBundle:Components/Page:_page-section-title.html.twig' with {
                  transDomain: translationDomain,
                  pageSectionTitle: 'pages.additionalInformation.subSectionTitle'
              } %}
              <p class="page-section-description">{{ report.furtherInformation | nl2br }}</p>
          </div>
        {% endif %}

        {% include 'AppBundle:Report:_submission_declaration.html.twig' %}

    {% endif %}
{% endblock %}

{% block popups %}
  {% if not isEmailAttachment%}
      {% include 'AppBundle:Components/Resources:_popups.html.twig' %}
  {% endif %}
{% endblock %}
