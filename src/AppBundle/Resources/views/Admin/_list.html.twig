<div class="behat-region-users user-list">

    <h1 class="form-title heading-medium-large" id="users-list-title">
        User list
    </h1>

  <table>
    <thead>
      <tr>
        <th scope="col">
            {% if (app.request.query.has('order_by')) and (app.request.query.get('order_by') == 'firstname') %}
                <a href="{{url('admin_homepage', { 'order_by': 'firstname', 'sort_order': newSortOrder })}}#users-list-title"> Firstname</a>

                {% if app.request.query.get('sort_order') == "ASC" %}
                         (a-z)
                {% else %}
                         (z-a)
                {% endif %}

            {% else %}
                <a href="{{url('admin_homepage', { 'order_by': 'firstname', 'sort_order': 'DESC' })}}#users-list-title" > Firstname</a>
            {% endif %}
        </th>

        <th scope="col">
           {% if (app.request.query.has('order_by')) and (app.request.query.get('order_by') == 'lastname') %}
                <a href="{{url('admin_homepage', { 'order_by': 'lastname', 'sort_order': newSortOrder })}}#users-list-title">Lastname</a>

                {% if app.request.query.get('sort_order') == "ASC" %}
                         (a-z)
                {% else %}
                         (z-a)
                {% endif %}

           {% else %}
                <a href="{{url('admin_homepage', { 'order_by': 'lastname', 'sort_order': 'ASC' })}}#users-list-title"  >Lastname</a>
           {% endif %}
        </th>
        <th scope="col">
               {% if (app.request.query.has('order_by')) and (app.request.query.get('order_by') == 'email') %}
                      <a href="{{url('admin_homepage', { 'order_by': 'email', 'sort_order': newSortOrder })}}#users-list-title">Email</a>

                      {% if app.request.query.get('sort_order') == "ASC" %}
                            (a-z)
                      {% else %}
                            (z-a)
                      {% endif %}

               {% else %}
                      <a href="{{url('admin_homepage', { 'order_by': 'email', 'sort_order': 'ASC' })}}#users-list-title" >Email</a>
               {% endif %}
        </th>
        <th scope="col">Role</th>
        <th scope="col">
            {% if (app.request.query.has('order_by')) and (app.request.query.get('order_by') == 'registrationDate') %}
                      <a href="{{url('admin_homepage', { 'order_by': 'registrationDate', 'sort_order': newSortOrder })}}#users-list-title">Registration date</a>

                      {% if app.request.query.get('sort_order') == "ASC" %}
                            (a-z)
                      {% else %}
                            (z-a)
                      {% endif %}

               {% else %}
                      <a href="{{url('admin_homepage', { 'order_by': 'registrationDate', 'sort_order': 'ASC' })}}#users-list-title" >Registration date</a>
               {% endif %}
        </th>
      </tr>
    </thead>
    <tbody>

    {# simple paginator #}
    <div style="float: right">
        {{ userCount }} users in total.
        {% if userCount > limit %}
            Go to page 
            {% set pages = range(0, userCount, limit) %}
            {% for currentOffset in pages %}
                {% if currentOffset == offset %}
                    {{ loop.index }}
                {% else %}
                    <a href="{{  path("admin_homepage", {"offset": currentOffset}) }}#users-list-title">{{ loop.index }}</a> 
                {% endif %}
            {% endfor %}
        {% endif %}
    </div>

    {% for user in users %}
      <tr>
          <td>
              {#{% if (app.user.id  != user.id) and (app.user.roleId != user.roleId) %}
                    <a href='{{ path('admin_editUser', { id: user.id })}}'>{{ user.firstname }}</a>
              {% else %}
                  {{ user.firstname }}
              {% endif %}#}
              <a href='{{ path('admin_editUser', { id: user.id })}}' class="behat-link-user-{{ user.email }}" >{{ user.firstname }}</a>
          </td>
        <td>{{ user.lastname }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.role.name }} {% if app.user.id == user.id %} (currenty logged){% endif %}</td>
        <td>{{ user.registrationDate ? user.registrationDate | date("d/m/Y") : 'n.a.' }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
</div>









