{% extends 'AppBundle:Layouts:application.html.twig' %}

{% import 'AppBundle:Macros:macros.html.twig' as macros %}

{% set translationDomain = "report-prof-current-fees" %}
{% trans_default_domain translationDomain %}
{% if step == 1 %}
    {% set page = 'addTypePage' %}
{% elseif step == 2 %}
    {% set page = 'addDetailsPage' %}
{% elseif step == 3 %}
    {% set page = 'estCostsPage' %}
{% endif %}


{% block htmlTitle %}{{ (page ~ '.htmlTitle') | trans }}{% endblock %}
{% block pageTitle %}{{ (page ~ '.pageTitle') | trans }}{% endblock %}
{% block pageTitleClass %}heading-large{% endblock %}

{% block supportTitleTop %}
    {% if not (step == 3) %}
        <span class="heading-secondary">{{ (page ~ '.supportTitle') | trans }}</span>
    {% endif %}
{% endblock %}

{# {% block linkBack %}
    {{ macros.linkBackStep(backLink, 'back' | trans({}, 'common')) }}
{% endblock %} #}

{% block pageContent %}

    {{ form_start(form, {attr: {novalidate: 'novalidate' }}) }}

    {{ form_widget(form.id, { 'attr': {'class': 'hidden-row'} }) }}

    {% if step == 1 %}
        <div class="form-section push--bottom">
            {{ form_checkbox_group(form.serviceTypeId, 'form.serviceTypeId', {
                'legendClass' : 'form-label-bold',
                'legendText' : (page ~ '.form.label') | trans,
                'formGroupClass': 'push--top'
            }) }}
        </div>

    {% elseif step == 2 %}
        <div class="form-section push--bottom">
            {{ form_checkbox_group(form.assessedOrFixed, 'form.assessedOrFixed', {
                'legendClass' : 'form-label-bold',
                'legendText' : (page ~ '.form.assessedOrFixed.legend') | trans,
                'formGroupClass': 'inline push--top'
            }) }}
        </div>

        <div>
            {{ form_input(form.amountCharged, 'addDetailsPage.form.amountCharged', {
                'inputPrefix' : '£',
                'inputClass' : 'form-control-1-4 js-format-currency',
                'labelClass' : 'form-label-bold',
                'formGroupClass': ' form-group-value'
            }) }}
        </div>

        <div class="form-section push--bottom">
            <div class="form-group flush--bottom {% if not form.paymentReceived.vars.valid %}form-group-error{% endif %}">
                {{ form_checkbox_group(form.paymentReceived, 'form.paymentReceived', {
                    'legendClass' : 'form-label-bold',
                    'legendText' : (page ~ '.form.paymentReceived.legend') | trans,
                    'formGroupClass': 'inline push--top flush--bottom',
                    'items': [
                        {'dataTarget': 'was-payment-received'},
                        {}
                    ],
                }) }}
                <div id="was-payment-received" class="panel panel-border-narrow js-hidden">
                    {{ form_input(form.amountReceived, 'addDetailsPage.form.amountReceived', {
                        'inputPrefix' : '£',
                        'inputClass' : 'form-control-1-4 js-format-currency',
                        'labelClass' : 'form-label-bold',
                        'formGroupClass': ' form-group-value'
                    }) }}
                    {{ form_known_date(form.paymentReceivedDate, 'addDetailsPage.form.paymentReceivedDate') }}
                </div>
            </div>
        </div>

    {% elseif step == 3 %}

        <div class="form-section push--bottom">
            <div class="form-group flush--bottom ">

                <fieldset class="inline">
                    <legend class="form-label-bold text text push-half--bottom text push-half--bottom">Did you give OPG an estimate of your costs for the current reporting period in your last deputyship report or in your opening deputyship record?</legend>

                    <div class="multiple-choice text" data-target="reason-for-no-contact" value="no" aria-controls="reason-for-no-contact" aria-expanded="false">
                        <input type="radio" id="contact_exist_hasContacts_0" name="contact_exist[hasContacts]" required="required" class="" value="yes">
                        <label class="" for="contact_exist_hasContacts_0">Yes</label>
                    </div>

                    <div class="multiple-choice text">
                        <input type="radio" id="contact_exist_hasContacts_1" name="contact_exist[hasContacts]" required="required" class=""><label class="" for="contact_exist_hasContacts_1">No</label>
                    </div>

                    <div id="reason-for-no-contact" class="panel panel-border-narrow js-hidden">
                        <div id="form-group-contact_exist_reasonForNoContacts" class="form-group ">
                            <label class="form-label text required required" for="contact_exist_reasonForNoContacts">If your total charges are 20% or more above your estimate please provide an explanation for the SCCO.</label>
                            <textarea id="contact_exist_reasonForNoContacts" name="contact_exist[reasonForNoContacts]" required="required" class=" form-control "></textarea>
                        </div>
                    </div>

                </fieldset>
            </div>
        </div>

        <button type="submit" class="button behat-link-save-and-continue">Save and continue</button>

    {% endif %}

    {% if step == 2 %}
        <button type="submit" class="button push-half--right push-half--bottom">Save and add another</button><br>
        <p>or</p>
    {% endif %}

    {{ macros.saveAndContinueButton(form.save) }}


    {{ form_end(form) }}

{% endblock %}





