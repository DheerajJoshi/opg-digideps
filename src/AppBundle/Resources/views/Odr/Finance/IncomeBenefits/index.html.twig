{% embed 'AppBundle:Layouts:odr_left_nav.html.twig' %}

    {% set translationDomain = "odr-income-benefits" %}
    {% trans_default_domain translationDomain %}

    {% set clientTrans = {'%client%': odr.client.firstname} %}

    {% block pageTitle %}{{ 'page.htmlTitle' | trans }}{% endblock %}
    {% block title %}
        {{ 'page.pageSectionTitle' | trans(clientTrans) }}
    {% endblock %}

    {% block leftcontent %}
        {% include 'AppBundle:Odr/Finance:left-nav.html.twig' %}
    {% endblock %}

    {% block maincontent %}

        <p class="page-section-description">
            {{ 'page.pageDescription' | trans(clientTrans, translationDomain) }}</p>

        {{ form_start(form, {attr: {novalidate: 'novalidate', class: 'expanding-transaction-table form-horizontal' }}) }}
        <div class="sections">
            {% include 'AppBundle:Odr/Finance/IncomeBenefits:_checkboxes.html.twig' with {
            categoryKey: 'stateBenefits',
            formElements: form.stateBenefits,
            } %}

            {% embed 'AppBundle:Odr/Finance/IncomeBenefits:_simple_elements.html.twig' with {
            categoryKey: 'pensionsOtherIncome',
            } %}
                {% block elements %}
                    <fieldset>
                        <legend class="hidden">receiveStatePension</legend>
                        {{ form_checkbox_group(form.receiveStatePension, 'xxx', {
                            'fieldSetClass' : 'inline expect-financial-dec-radio',
                            'legendClass' : 'form-label',
                            'legendText' : 'form.receiveStatePension.label' | trans(clientTrans, translationDomain),
                            'hintText' : 'form.receiveStatePension.hint' | trans(clientTrans, translationDomain),
                            'items': [
                            {'labelClass': 'block-label', 'elementClass': '' },
                            {'labelClass': 'block-label', 'elementClass': '' }
                            ]
                        }) }}
                    </fieldset>

                    <fieldset>
                        <legend class="hidden">receiveOtherIncome</legend>
                        {{ form_checkbox_group(form.receiveOtherIncome, 'xxx', {
                            'fieldSetClass' : 'inline',
                            'legendClass' : 'form-label',
                            'legendText' : 'form.receiveOtherIncome.label' | trans(clientTrans, translationDomain),
                            'hintText' : 'form.receiveOtherIncome.hint' | trans(clientTrans, translationDomain),
                            'items': [
                            {'labelClass': 'block-label', 'elementClass': '' },
                            {'labelClass': 'block-label', 'elementClass': '' }
                            ]
                        }) }}
                        <div id="financial-decisions-textarea" class="hidden-detail">
                            {{ form_input(form.receiveOtherIncomeDetails, 'form.receiveOtherIncomeDetails', {
                                'labelClass': 'required',
                                'labelParameters': { '%client%': odr.client.firstname },
                                'inputClass': 'expanding'
                            }) }}
                        </div>
                    </fieldset>
                {% endblock %}
            {% endembed %}


            {% embed 'AppBundle:Odr/Finance/IncomeBenefits:_simple_elements.html.twig' with {
            categoryKey: 'damages',
            } %}
                {% block elements %}
                    <fieldset>
                        <legend class="hidden">expectCompensationDamages</legend>
                        {{ form_checkbox_group(form.expectCompensationDamages, 'xxx', {
                            'fieldSetClass' : 'inline expect-financial-dec-radio',
                            'legendClass' : 'form-label',
                            'legendText' : 'form.expectCompensationDamages.label' | trans(clientTrans, translationDomain),
                            'hintText' : 'form.expectCompensationDamages.hint' | trans(clientTrans, translationDomain),
                            'items': [
                            {'labelClass': 'block-label', 'elementClass': '' },
                            {'labelClass': 'block-label', 'elementClass': '' }
                            ]
                        }) }}
                        <div id="" class="hidden-detail">
                            {{ form_input(form.expectCompensationDamagesDetails, 'form.expectCompensationDamagesDetails', {
                                'labelClass': 'required',
                                'labelParameters': { '%client%': odr.client.firstname },
                                'inputClass': 'expanding'
                            }) }}
                        </div>
                    </fieldset>
                {% endblock %}
            {% endembed %}

            {# oneOff #}
            {% include 'AppBundle:Odr/Finance/IncomeBenefits:_checkboxes.html.twig' with {
            categoryKey: 'oneOff',
            formElements: form.oneOff,
            } %}
        </div>

        <div class="save-bar button-bar">
            {{ form_submit(form.save,'form.save', { 'buttonClass': '' }) }}
        </div>

        {{ form_end(form) }}

        <script>
            $(document).ready(function () {
                new GOVUK.ExpandingTransactionTable('.expanding-transaction-table');
                {#new GOVUK.AutoSave({#}
                {#form: $('form.expanding-transaction-table'),#}
                {#statusElement: $('#save-status'),#}
                {#url: '{{ path('accounts_money_save_json', {'reportId': odr.id, 'type': jsonEndpoint}) }}',#}
                {#preprocessor: GOVUK.moneyInOuPreprocessor#}
                {#});#}
//                $('form.expanding-transaction-table button[type="submit"]').hide();

//                $('.add-transaction').removeClass('hidden');

//                $('input.transaction-value').on('blur', function (event) {
//                    GOVUK.formatCurrency(event.target);
//                });

                GOVUK.accountTransactionExpander();
            });
        </script>



    {% endblock %}

    {% block pageBodyFooterNav %}
        {% include 'AppBundle:Components:nextprevious.html.twig' with {
        'previousLink': path("odr_overview" , {'odrId': odr.id }),
        'previousLabel': 'Visits and care',
        'nextLink': path("odr_overview" , {'odrId': odr.id }),
        'nextLabel': 'Money transfers'
        } %}
    {% endblock %}


{% endembed %}
