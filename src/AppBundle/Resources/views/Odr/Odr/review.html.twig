{% extends 'AppBundle:Layouts:application.html.twig' %}
{% set isLayDeputy = not app.user.isDeputyPa %}

{% block htmlTitle %}Review new deputy report{% endblock %}
{% block pageTitle %}Review new deputy report{% endblock %}
{% block pageTitleClass %}heading-large{% endblock %}

{% block breadcrumbs %}
    {% if odr.submitted == true %}
        <a id="overview-button" href="{{ path('homepage') }}" class="link-back">Your reports</a>
    {% else %}
        <div class="breadcrumbs hard--bottom">
            <ol class="group">
                <li><a href="{{ path('homepage') }}">{{ 'yourReports' | trans({}, 'common' ) }}</a></li>
                <li><a href="{{ path("odr_overview" , {'odrId': odr.id }) }}">{{ 'deputyReportOverview' | trans({}, 'common' ) }}</a></li>
            </ol>
        </div>
    {% endif %}
{% endblock %}

{% if isLayDeputy %}
    <div id="page-body">
        <p>
            {{ 'incomplete.introPara' | trans() }}
        </p>
    </div>
{% else %}
    {% macro nextPrevSubmitButtons(odr, odrStatus, position, nextAdditionalClass) %}
        {% if odr.submitted == false %}
            {% if odrStatus.isReadyToSubmit %}
                {% include 'AppBundle:Components:nextprevioussimple.html.twig' with {
                'previousLink': path("odr_overview" , {'odrId': odr.id}),
                'previousLabel': 'Edit new deputy report',
                'nextLink': path("odr_declaration", {'odrId': odr.id}),
                'nextLabel': 'Submit report',
                'position': position,
                'nextAdditionalClass': nextAdditionalClass,
                } %}
            {% else  %}
                {% include 'AppBundle:Components:nextprevioussimple.html.twig' with {
                'previousLink': path("odr_overview" , {'odrId': odr.id }),
                'previousLabel': 'Edit new deputy report',
                'position': position,
                } %}
            {% endif %}
        {% endif %}
    {% endmacro %}
{% else %}


{% endif %}
{% block pageContent %}

    {{ _self.nextPrevSubmitButtons(odr, odrStatus, 'top', 'behat-link-sign-and-submit') }}
    <div id="page-body">
        <a class="pdflink" href="{{ path('odr_pdf', {'odrId': odr.id}) }}">Download as PDF</a>
        {% include 'AppBundle:Odr/Formatted:formatted.html.twig' %}
    </div>

    <div id="body-footer-nav">
        {{ _self.nextPrevSubmitButtons(odr, odrStatus, 'bottom') }}
    </div>

    <script>
        $(document).ready(function() {
            var ga = new opg.Ga({'timeout': 250});
            ga.trackDownloadableLink($('.pdflink'));
        });
    </script>
{% endblock %}
