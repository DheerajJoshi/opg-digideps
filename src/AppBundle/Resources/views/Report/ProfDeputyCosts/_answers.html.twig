{% set translationDomain = "report-prof-deputy-costs" %}
{% trans_default_domain translationDomain %}
{% set transOptions = {'%client%': report.client.firstname | e } %}
{% set append104 = report.get104TransSuffix %}

{% set hideEditLink = hideEditLink | default(false) %}

<table class="check-your-answers columns-2 push--bottom">
    {{ macros.summaryTableHeaderQA(hideEditLink) }}
    <tbody>
        {# How did you charge for your costs? #}
        <tr class="behat-region-how-changed">
                <td>
                    {{ 'howCharged.form.profDeputyCostsHow.label' | trans }}
                </td>
                <td>
                    {{ report.profDeputyCostsHowChargedFixed ? 'Fixed<br>' : '' | raw }}
                    {{ report.profDeputyCostsHowChargedAssessed ? 'Assessed<br>' : '' | raw }}
                    {{ report.profDeputyCostsHowChargedAgreed  ? 'Agreed<br>' : '' | raw}}
                </td>
            {% if not hideEditLink  %}
                <td class="change-answer">
                    <a href="{{ path('prof_deputy_costs_how_charged', {'reportId': report.id, 'from': 'summary'}) }}" class="behat-link-edit action-link">{{ 'edit' | trans({}, 'common' ) }}</a>
                </td>
            {% endif %}
        </tr>


        {# Are there any remaining fees #}
        <tr class="behat-region-has-previous">
            <td>
                {% if report.profDeputyCostsHasPrevious is null %}<span class="error">{% endif %}
                {{ 'previousReceivedExists.form.profDeputyCostsHasPrevious.label' | trans(transOptions) }}
                {% if report.profDeputyCostsHasPrevious is null %}</span>{% endif %}
            </td>
            <td>
                {% if  report.profDeputyCostsHasPrevious is null %}
                    <span class="error-message">{{ 'pleaseAnswer' | trans({}, 'common' ) }}</span>
                {% else %}
                    {{ report.profDeputyCostsHasPrevious | capitalize }}
                {% endif %}
            </td>
            {% if not hideEditLink  %}
                <td class="change-answer">
                    <a href="{{ path('prof_deputy_costs_previous_received_exists', {'reportId': report.id, 'from': 'summary'}) }}" class="action-link behat-link-edit">{{ 'edit' | trans({}, 'common' ) }}</a>
                </td>
            {% endif %}
        </tr>

        {% for pc in report.profDeputyPreviousCosts %}
            <tr class="behat-region-prev-costs">
                <td>
                    Received for {{ pc.startDate | date('d/m/Y') }} - {{ pc.endDate | date('d/m/Y') }}
                    {#{{ 'previousReceivedExists.form.profDeputyCostsHasPrevious.label' | trans(transOptions) }}#}
                </td>
                <td>
                    £{{ pc.amount | money_format }}
                </td>
                {% if not hideEditLink  %}
                    <td class="change-answer width-sixth soft-half--left hard--right">
                        <a href="{{ path('prof_deputy_costs_previous_received', {'reportId': report.id, 'previousReceivedId': pc.id, 'from': 'summary'}) }}" class="action-link behat-link-edit">{{ 'edit' | trans({}, 'common' ) }}</a>
                        <a href="{{ path('prof_deputy_costs_previous_received_delete', {'reportId': report.id, 'previousReceivedId': pc.id}) }}" class="action-link behat-link-delete">{{ 'remove' | trans({}, 'common' ) }}</a>
                    </td>
                {% endif %}
            </tr>
        {% endfor %}


        {# Have you charged in line with interim billing under Practice Direction 19B  #}
        {% if not report.hasProfDeputyCostsHowChargedFixedOnly %}
            <tr class="behat-region-has-interim">
                <td>
                    {% if report.profDeputyCostsHasInterim is null %}<span class="error">{% endif %}
                    {{ 'interimExists.form.profDeputyCostsHasInterim.label' | trans(transOptions) }}
                    {% if report.profDeputyCostsHasInterim is null %}</span>{% endif %}
                </td>
                <td>
                    {% if report.profDeputyCostsHasInterim is null %}
                        <span class="error-message">{{ 'pleaseAnswer' | trans({}, 'common' ) }}</span>
                    {% else %}
                        {{ report.profDeputyCostsHasInterim | capitalize }}
                    {% endif %}
                </td>
                {% if not hideEditLink  %}
                    <td class="change-answer">
                        <a href="{{ path('prof_deputy_costs_inline_interim_19b_exists', {'reportId': report.id, 'from': 'summary'}) }}" class="action-link behat-link-edit">{{ 'edit' | trans({}, 'common' ) }}</a>
                    </td>
                {% endif %}
            </tr>

            {% for ic in report.profDeputyInterimCosts %}
                <tr class="behat-region-prev-costs">
                    <td>
                        Costs for interim {{ loop.index }}
                    </td>
                    <td>
                        £{{ ic.amount | money_format }}, paid {{  ic.date | date('d/m/Y') }}
                    </td>
                    {% if not hideEditLink  %}
                        <td class="change-answer width-sixth soft-half--left hard--right">
                            <a href="{{ path('prof_deputy_costs_inline_interim_19b', {'reportId': report.id, 'from': 'summary'}) }}" class="action-link behat-link-edit">{{ 'edit' | trans({}, 'common' ) }}</a>
                        </td>
                    {% endif %}
                </tr>
            {% endfor %}

        {% endif %}

        {# SCCO assessment #}
        <tr class="behat-region-scco-assessment-amount">
            <td>
                {{ 'amountToScco.form.profDeputyCostsAmountToScco.label' | trans }}
            </td>
            <td>
                {{ report.profDeputyCostsAmountToScco | raw }}
            </td>
            {% if not hideEditLink  %}
                <td class="change-answer">
                    <a href="{{ path('prof_deputy_costs_amount_scco', {'reportId': report.id, 'from': 'summary'}) }}" class="behat-link-edit action-link">{{ 'edit' | trans({}, 'common' ) }}</a>
                </td>
            {% endif %}
        </tr>
        <tr class="behat-region-scco-assessment-reason">
            <td>
                {{ 'amountToScco.form.profDeputyCostsReasonBeyondEstimate.label' | trans }}
            </td>
            <td>
                {{ report.profDeputyCostsReasonBeyondEstimate | raw }}
            </td>
            {% if not hideEditLink  %}
                <td class="change-answer">
                    <a href="{{ path('prof_deputy_costs_amount_scco', {'reportId': report.id, 'from': 'summary'}) }}" class="behat-link-edit action-link">{{ 'edit' | trans({}, 'common' ) }}</a>
                </td>
            {% endif %}
        </tr>
    </tbody>
</table>
