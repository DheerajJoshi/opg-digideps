{% set translationDomain = "report-prof-deputy-costs-estimate" %}
{% trans_default_domain translationDomain %}
{% set transOptions = {'%client%': report.client.firstname | e } %}

{% set hideEditLink = hideEditLink | default(false) %}

<h2 class="heading-medium">{{ (page ~ '.weveListedYourAnswers') | trans }}</h2>

<p class="text">{{ (page ~ '.checkTheyreCorrect') | trans }}</p>

<a href="{{path('org_dashboard')}}" class="right behat-link-return-to-org-dashboard">{{ (page ~ '.returnToClientProfile') | trans }}</a>

<table class="check-your-answers columns-2 push--bottom">
    {{ macros.summaryTableHeaderQA(hideEditLink) }}
    <tbody>
        {# How did you charge for your costs? #}
        <tr class="behat-region-how-changed">
                <td>
                    {{ 'howCharged.form.profDeputyCostsEstimateHowCharged.label' | trans(transOptions) }}
                </td>
                <td>
                    {{ howCharged(report.profDeputyCostsEstimateHowCharged) }}
                </td>
            {% if not hideEditLink  %}
                <td class="change-answer">
                    <a href="{{ path('prof_deputy_costs_estimate_how_charged', {'reportId': report.id, 'from': 'summary'}) }}" class="behat-link-edit action-link">{{ 'edit' | trans({}, 'common' ) }}</a>
                </td>
            {% endif %}
        </tr>

        {# Breakdown of estimated costs #}
        {% if submittedEstimateCosts is not null %}
            {% for estimateCostTypeId in report.getProfDeputyEstimateCostTypeIds %}
                {% set costRow = submittedEstimateCosts[estimateCostTypeId.typeId] %}
                <tr class="behat-region-breakdown-{{ estimateCostTypeId.typeId | lower }}">
                    <td>
                        {{ ('breakdown.form.entries.' ~ estimateCostTypeId.typeId ~ '.label') | trans }}
                    </td>
                    <td>
                        {% if costRow['amount'] is null %}
                            -
                        {% else %}
                            £{{ costRow['amount'] | money_format }}
                        {% endif %}
                    </td>
                    {% if not hideEditLink %}
                        <td class="change-answer width-sixth soft-half--left hard--right">
                            <a href="{{ path('prof_deputy_costs_breakdown', {'reportId': report.id, 'from': 'summary'}) }}"
                               class="action-link behat-link-edit">{{ 'edit' | trans({}, 'common' ) }}</a>
                        </td>
                    {% endif %}
                </tr>
                {# more details ("estimate" only) #}
                {% if costRow.hasMoreDetails and costRow.moreDetails %}
                  <tr class="behat-region-breakdown-{{ estimateCostTypeId.typeId | lower }}-details">
                    <td>
                        {{ ('breakdown.form.entries.' ~ estimateCostTypeId.typeId ~ '.moreInformationLabelSummary') | trans }}
                    </td>
                    <td>
                        {{  costRow.moreDetails | nl2br }}
                    </td>
                    {% if not hideEditLink %}
                        <td class="change-answer width-sixth soft-half--left hard--right">
                            <a href="{{ path('prof_deputy_costs_breakdown', {'reportId': report.id, 'from': 'summary'}) }}"
                               class="action-link behat-link-edit">{{ 'edit' | trans({}, 'common' ) }}</a>
                        </td>
                    {% endif %}
                  </tr>
                {% endif %}
            {% endfor %}

            <tr class="behat-region-total-estimate-cost">
                <td>
                    <strong class="bold">{{ (page ~ '.totalEstimatedCosts') | trans(transOptions) }}</strong>
                </td>
                <td>
                    <strong class="bold">£{{ report.profDeputyEstimateCostsTotal | money_format }}</strong>
                </td>
                <td></td>
            </tr>

        {% endif %}
    </tbody>
</table>
